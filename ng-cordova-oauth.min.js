// ng-cordova-oauth - v0.2.0 (2014-11-04)
// http://www.nraboy.com
!function(){angular.module("ngCordovaOauth",[]).factory("$cordovaOauth",["$q","$http",function(a,b){return{dropbox:function(b){var c=a.defer();if(window.cordova){var d=window.open("https://www.dropbox.com/1/oauth2/authorize?client_id="+b+"&redirect_uri=http://localhost/callback&response_type=token","_blank","location=no,clearsessioncache=yes,clearcache=yes");d.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){for(var b=a.url.split("#")[1],e=b.split("&"),f=[],g=0;g<e.length;g++)f[e[g].split("=")[0]]=e[g].split("=")[1];void 0!==f.access_token&&null!==f.access_token?c.resolve({access_token:f.access_token,token_type:f.token_type,uid:f.uid}):c.reject("Problem authenticating"),d.close()}})}else c.reject("Cannot authenticate via a web browser");return c.promise},digitalOcean:function(c,d){var e=a.defer();if(window.cordova){var f=window.open("https://cloud.digitalocean.com/v1/oauth/authorize?client_id="+c+"&redirect_uri=http://localhost/callback&response_type=code&scope=read%20write","_blank","location=no,clearsessioncache=yes,clearcache=yes");f.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){var g=a.url.split("code=")[1];b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b({method:"post",url:"https://cloud.digitalocean.com/v1/oauth/token",data:"client_id="+c+"&client_secret="+d+"&redirect_uri=http://localhost/callback&grant_type=authorization_code&code="+g}).success(function(a){e.resolve(a)}).error(function(){e.reject("Problem authenticating")}),f.close()}})}else e.reject("Cannot authenticate via a web browser");return e.promise},google:function(b,c){var d=a.defer();if(window.cordova){var e=window.open("https://accounts.google.com/o/oauth2/auth?client_id="+b+"&redirect_uri=http://localhost/callback&scope="+c.join(" ")+"&approval_prompt=force&response_type=token","_blank","location=no,clearsessioncache=yes,clearcache=yes");e.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){for(var b=a.url.split("#")[1],c=b.split("&"),f=[],g=0;g<c.length;g++)f[c[g].split("=")[0]]=c[g].split("=")[1];void 0!==f.access_token&&null!==f.access_token?d.resolve({access_token:f.access_token,token_type:f.token_type,expires_in:f.expires_in}):d.reject("Problem authenticating"),e.close()}})}else d.reject("Cannot authenticate via a web browser");return d.promise},github:function(c,d,e){var f=a.defer();if(window.cordova){var g=window.open("https://github.com/login/oauth/authorize?client_id="+c+"&redirect_uri=http://localhost/callback&scope="+e.join(","),"_blank","location=no,clearsessioncache=yes,clearcache=yes");g.addEventListener("loadstart",function(a){0===a.url.indexOf("http://localhost/callback")&&(requestToken=a.url.split("code=")[1],b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b.defaults.headers.post.accept="application/json",b({method:"post",url:"https://github.com/login/oauth/access_token",data:"client_id="+c+"&client_secret="+d+"&redirect_uri=http://localhost/callback&code="+requestToken}).success(function(a){f.resolve(a)}).error(function(){f.reject("Problem authenticating")}),g.close())})}else f.reject("Cannot authenticate via a web browser");return f.promise},facebook:function(b,c){var d=a.defer();if(window.cordova){var e=window.open("https://www.facebook.com/dialog/oauth?client_id="+b+"&redirect_uri=http://localhost/callback&response_type=token&scope="+c.join(","),"_blank","location=no,clearsessioncache=yes,clearcache=yes");e.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){for(var b=a.url.split("#")[1],c=b.split("&"),f=[],g=0;g<c.length;g++)f[c[g].split("=")[0]]=c[g].split("=")[1];void 0!==f.access_token&&null!==f.access_token?d.resolve({access_token:f.access_token,expires_in:f.expires_in}):d.reject("Problem authenticating"),e.close()}})}else d.reject("Cannot authenticate via a web browser");return d.promise},linkedin:function(c,d,e,f){var g=a.defer();if(window.cordova){var h=window.open("https://www.linkedin.com/uas/oauth2/authorization?client_id="+c+"&redirect_uri=http://localhost/callback&scope="+e.join(" ")+"&response_type=code&state="+f,"_blank","location=no,clearsessioncache=yes,clearcache=yes");h.addEventListener("loadstart",function(a){0===a.url.indexOf("http://localhost/callback")&&(requestToken=a.url.split("code=")[1],b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b({method:"post",url:"https://www.linkedin.com/uas/oauth2/accessToken",data:"client_id="+c+"&client_secret="+d+"&redirect_uri=http://localhost/callback&grant_type=authorization_code&code="+requestToken}).success(function(a){g.resolve(a)}).error(function(){g.reject("Problem authenticating")}),h.close())})}else g.reject("Cannot authenticate via a web browser");return g.promise},instagram:function(b,c){var d=a.defer();if(window.cordova){var e=window.open("https://api.instagram.com/oauth/authorize/?client_id="+b+"&redirect_uri=http://localhost/callback&scope="+c.join(" ")+"&response_type=token","_blank","location=no,clearsessioncache=yes,clearcache=yes");e.addEventListener("loadstart",function(a){if(0===a.url.indexOf("http://localhost/callback")){for(var b=a.url.split("#")[1],c=b.split("&"),f=[],g=0;g<c.length;g++)f[c[g].split("=")[0]]=c[g].split("=")[1];void 0!==f.access_token&&null!==f.access_token?d.resolve({access_token:f.access_token}):d.reject("Problem authenticating"),e.close()}})}else d.reject("Cannot authenticate via a web browser");return d.promise},box:function(c,d,e){var f=a.defer();if(window.cordova){var g=window.open("https://app.box.com/api/oauth2/authorize/?client_id="+c+"&redirect_uri=http://localhost/callback&state="+e+"&response_type=code","_blank","location=no,clearsessioncache=yes,clearcache=yes");g.addEventListener("loadstart",function(a){0===a.url.indexOf("http://localhost/callback")&&(requestToken=a.url.split("code=")[1],b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b({method:"post",url:"https://app.box.com/api/oauth2/token",data:"client_id="+c+"&client_secret="+d+"&redirect_uri=http://localhost/callback&grant_type=authorization_code&code="+requestToken}).success(function(a){f.resolve(a)}).error(function(){f.reject("Problem authenticating")}),g.close())})}else f.reject("Cannot authenticate via a web browser");return f.promise},reddit:function(c,d,e){var f=a.defer();if(window.cordova){var g=window.open("https://ssl.reddit.com/api/v1/authorize?client_id="+c+"&redirect_uri=http://localhost/callback&duration=permanent&state=ngcordovaoauth&scope="+e.join(",")+"&response_type=code","_blank","location=no,clearsessioncache=yes,clearcache=yes");g.addEventListener("loadstart",function(a){0===a.url.indexOf("http://localhost/callback")&&(requestToken=a.url.split("code=")[1],b.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",b.defaults.headers.post.Authorization="Basic "+btoa(c+":"+d),b({method:"post",url:"https://ssl.reddit.com/api/v1/access_token",data:"redirect_uri=http://localhost/callback&grant_type=authorization_code&code="+requestToken}).success(function(a){f.resolve(a)}).error(function(){f.reject("Problem authenticating")}),g.close())})}else f.reject("Cannot authenticate via a web browser");return f.promise}}}])}();